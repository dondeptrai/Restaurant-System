{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Restaurant Table Reservation</title>
    <link rel="stylesheet" href="{% static 'styles.css' %}">
    <link rel="stylesheet" href="{% static 'test.css' %}">
</head>
<body>
    <header class="header">
        <div class="header-left">
            <h1>Dashboard</h1>
        </div>
        <div class="header-right">
        <form method="GET" action="{% url 'search_orders' %}">
            <input type="text" name="search" placeholder="Tìm kiếm..." onkeydown="if(event.key === 'Enter') this.form.submit();">
        </form>
        <div class="icon user-icon">
            {% if request.session.customer_name %}
                <span>Xin chào, {{ request.session.customer_name }}!</span>
                <a href="{% url 'logout' %}" class="logout-link">Đăng xuất</a>
            {% else %}
                <a href="{% url 'login' %}">
                    <img class="user" src="{% static 'img/usert.png' %}" alt="User Icon">
                </a>
            {% endif %}
        </div>
        
    </header>
    <aside class="sidebar">
        <div class="sidebar-header">
            <h2>Demo Restaurant</h2>
        </div>
        <nav class="menu">
            <a href="#" class="menu-item">Floor</a>
            <a href="#" class="menu-item">Gridview</a>
            <a href="#" class="menu-item">Timeline</a>
            <a href="#" class="menu-item">Guest</a>
            <a href="#" class="menu-item">Chat</a>
            <a href="#" class="menu-item">Report</a>
            <a href="#" class="menu-item">Support</a>
            <a href="#" class="menu-item">Settings</a>
        </nav>
    </aside>

<div class="container">
    <aside class="reservation-list">
        <h2>Reservations</h2>

        <h3>Lunch</h3>
        <div class="reservation-columns">
            {% for order in lunch_orders %}
                <div class="reservation">
                    <p><strong>{{ order.customer.customer_name }}</strong></p>
                    <p>{{ order.numof_customer }} Person - Table {{ order.ordertable_set.first.table.id }}</p>
                    <p>{{ order.begin_time|date:"H:i A" }}</p>
                </div>
            {% empty %}
                <p>No lunch reservations available.</p>
            {% endfor %}
        </div>

        <h3>Dinner</h3>
        <div class="reservation-columns">
            {% for order in dinner_orders %}
                <div class="reservation">
                    <p><strong>{{ order.customer.customer_name }}</strong></p>
                    <p>{{ order.numof_customer }} Person - Table {{ order.ordertable_set.first.table.id }}</p>
                    <p>{{ order.begin_time|date:"H:i A" }}</p>
                </div>
            {% empty %}
                <p>No dinner reservations available.</p>
            {% endfor %}
        </div>
    </aside>




        <!-- Right section: Tables -->
        <main class="table-layout">
            <!-- Taskbar with tabs for each area -->
            <div class="tabs">
                <div class="tab" data-target="main-dining-room">Main Dining Room</div>
                <div class="tab" data-target="outdoor">Outdoor</div>
                <div class="tab" data-target="terrace">Terrace</div>
            </div>

            <!-- Main Dining Room Section -->
            <div id="main-dining-room" class="table-section">
                <h2>Main Dining Room</h2>
                <div class="tables">
                    {% for table in main_dining_tables %}
                        <div class="table
                            {% if table.status == 'reserved' %}reserved{% endif %}
                            {% if table.seat_num > 4 and table.status != 'reserved' %}vip{% endif %}"
                            data-id="{{ table.id }}"
                            data-status="{{ table.status }}"
                            data-seat_num="{{ table.seat_num }}"
                            data-type="Main Dining Room"
                            onclick="showTableInfo(this)">
                            {{ table.id }}
                        </div>
                    {% empty %}
                        <p>No tables available.</p>
                    {% endfor %}
                </div>
            </div>




            <!-- Outdoor Section -->
            <div id="outdoor" class="table-section">
                <h2>Outdoor</h2>
                <div class="tables">
                   {% for table in out_door  %}
                        <div class="table
                            {% if table.status == 'reserved' %}reserved{% endif %}
                            {% if table.seat_num > 4 and table.status != 'reserved' %}vip{% endif %}"
                            data-id="{{ table.id }}"
                            data-status="{{ table.status }}"
                            data-seat_num="{{ table.seat_num }}"
                            data-type="Main Dining Room"
                            onclick="showTableInfo(this)">
                            {{ table.id }}
                        </div>
                    {% empty %}
                        <p>No tables available.</p>
                   {% endfor %}
                </div>
            </div>



            <!-- Terrace Section -->
            <div id="terrace" class="table-section">
                <h2>Terrace</h2>
                <div class="tables">
                    {% for table in roof_top %}
                        <div class="table
                            {% if table.status == 'reserved' %}reserved{% endif %}
                            {% if table.seat_num > 4 and table.status != 'reserved' %}vip{% endif %}"
                            data-id="{{ table.id }}"
                            data-status="{{ table.status }}"
                            data-seat_num="{{ table.seat_num }}"
                            data-type="Main Dining Room"
                            onclick="showTableInfo(this)">
                            {{ table.id }}
                        </div>
                    {% empty %}
                        <p>No tables available.</p>
                    {% endfor %}
                </div>
            </div>

            <div id="table-info" style="display: none;">
                <h3>Table Information</h3>
                <p>Table Id: <span id="table-id"></span></p>
                <p>Status: <span id="table-status"></span></p>
                <p>Seat Number: <span id="table-seat"></span></p>
                <p>Section: <span id="table-type"></span></p>


                <form id="booking-form" action="{% url 'add_order' %}" method="post" style="display: none;">
                    {% csrf_token %}
                    <label for="begin_time">Begin Time:</label>
                    <input type="datetime-local" id="begin_time" name="begin_time" required>
                    
                    <label for="end_time">End Time:</label>
                    <input type="datetime-local" id="end_time" name="end_time" required>
                    <p></p>
                    
                    <label for="numof_customer">Number of Customers:</label>
                    <input type="number" id="numof_customer" name="numof_customer" required>
                    
                    <input type="hidden" id="table-id-input" name="table_id">
                    
                    <button type="submit">Confirm Booking</button>
                </form>
                
                
            </div>
        </main>
    </div>

    <script src="{% static 'script.js' %}"></script>
</body>
</html>
